{"version":3,"sources":["../../src/tests/Repository.js"],"names":["assert","exports","database","sqlite","Database","repository","Repository","schema","personSchema","TableCreator","createTableIfNotExistsAsync","then","addAsync","firstName","close","catch","error","id","lastID","updateAsync","where","column","isEqualTo","toArrayAsync","results","equal","length","removeAsync"],"mappings":"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","file":"Repository.js","sourcesContent":["import * as assert from \"assert\";\nimport sqlite from \"sqlite3\";\nimport Repository from \"../sqlite/Repository\";\nimport personSchema from \"../testSchemas/person\";\nimport TableCreator from \"../sqlite/TableCreator\";\n\nexports[\"Repository: addAsync\"] = function () {\n    const database = new sqlite.Database(\":memory:\");\n    const repository = new Repository({\n        database,\n        schema: personSchema\n    });\n\n    return TableCreator.createTableIfNotExistsAsync({\n        database,\n        schema: personSchema\n    }).then(() => {\n        return repository.addAsync({ firstName: \"John\" });\n    }).then(() => {\n        database.close();\n    }).catch((error) => {\n        database.close();\n        throw error;\n    })\n};\n\nexports[\"Repository: updateAsync\"] = function () {\n    const database = new sqlite.Database(\":memory:\");\n    const repository = new Repository({\n        database,\n        schema: personSchema\n    });\n\n    return TableCreator.createTableIfNotExistsAsync({\n        database,\n        schema: personSchema\n    }).then(() => {\n        return repository.addAsync({ firstName: \"John\" });\n    }).then(({ lastID: id }) => {\n        return repository.updateAsync({\n            id: id,\n            firstName: \"Jane\"\n        });\n    }).then(() => {\n        return repository.where().column(\"firstName\").isEqualTo(\"Jane\").toArrayAsync();\n    }).then((results) => {\n        assert.equal(results.length, 1);\n        database.close();\n    }).catch((error) => {\n        database.close();\n        throw error;\n    })\n};\n\nexports[\"Repository: removeAsync\"] = function () {\n    const database = new sqlite.Database(\":memory:\");\n    const repository = new Repository({\n        database,\n        schema: personSchema\n    });\n\n    return TableCreator.createTableIfNotExistsAsync({\n        database,\n        schema: personSchema\n    }).then(() => {\n        return repository.addAsync({ firstName: \"John\" });\n    }).then(({ lastID: id }) => {\n        return repository.removeAsync({\n            id: id\n        });\n    }).then(() => {\n        return repository.where().column(\"firstName\").isEqualTo(\"John\").toArrayAsync();\n    }).then((results) => {\n        assert.equal(results.length, 0);\n        database.close();\n    }).catch((error) => {\n        database.close();\n        throw error;\n    })\n};\n"]}